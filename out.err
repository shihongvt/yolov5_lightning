
Inactive Modules:
  1) cray     2) craype-network-infiniband     3) craype-x86-rome

Using cache found in /home/shihong/.cache/torch/hub/ultralytics_yolov5_master
YOLOv5 ðŸš€ 2023-8-28 Python-3.11.4 torch-2.0.1 CPU

Fusing layers... 
YOLOv5s summary: 213 layers, 7225885 parameters, 0 gradients
Adding AutoShape... 
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs

  | Name            | Type       | Params
-----------------------------------------------
0 | yolov5_backbone | AutoShape  | 7.2 M 
1 | features        | Sequential | 0     
2 | regression_head | Sequential | 629 M 
3 | criterion       | MSELoss    | 0     
-----------------------------------------------
629 M     Trainable params
7.2 M     Non-trainable params
636 M     Total params
2,545.490 Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
`Trainer.fit` stopped: `max_epochs=10` reached.
SLURM auto-requeueing enabled. Setting signal handlers.
Traceback (most recent call last):
  File "/home/shihong/yolov5_lightning/yolov5_lightning.py", line 183, in <module>
    trainer.test(model, datamodule=data_module)
  File "/home/shihong/.conda/envs/pytorch/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 742, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shihong/.conda/envs/pytorch/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shihong/.conda/envs/pytorch/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 785, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shihong/.conda/envs/pytorch/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 980, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/shihong/.conda/envs/pytorch/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1016, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shihong/.conda/envs/pytorch/lib/python3.11/site-packages/pytorch_lightning/loops/utilities.py", line 181, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shihong/.conda/envs/pytorch/lib/python3.11/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 98, in run
    self.setup_data()
  File "/home/shihong/.conda/envs/pytorch/lib/python3.11/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 150, in setup_data
    dataloaders = _request_dataloader(source)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shihong/.conda/envs/pytorch/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py", line 336, in _request_dataloader
    return data_source.dataloader()
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shihong/.conda/envs/pytorch/lib/python3.11/site-packages/pytorch_lightning/trainer/connectors/data_connector.py", line 303, in dataloader
    return call._call_lightning_datamodule_hook(self.instance.trainer, self.name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shihong/.conda/envs/pytorch/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 165, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/shihong/.conda/envs/pytorch/lib/python3.11/site-packages/pytorch_lightning/core/hooks.py", line 462, in test_dataloader
    raise MisconfigurationException("`test_dataloader` must be implemented to be used with the Lightning Trainer")
lightning_fabric.utilities.exceptions.MisconfigurationException: `test_dataloader` must be implemented to be used with the Lightning Trainer
